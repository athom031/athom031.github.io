<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Twitter Search Engine | Alex Thomas</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Twitter Search Engine" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Full-Stack Web Application" />
<meta property="og:description" content="Full-Stack Web Application" />
<link rel="canonical" href="http://localhost:4000/2020/09/04/Twitter-Search-Engine.html" />
<meta property="og:url" content="http://localhost:4000/2020/09/04/Twitter-Search-Engine.html" />
<meta property="og:site_name" content="Alex Thomas" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-09-04T00:00:00-07:00" />
<script type="application/ld+json">
{"datePublished":"2020-09-04T00:00:00-07:00","dateModified":"2020-09-04T00:00:00-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/09/04/Twitter-Search-Engine.html"},"url":"http://localhost:4000/2020/09/04/Twitter-Search-Engine.html","description":"Full-Stack Web Application","@type":"BlogPosting","headline":"Twitter Search Engine","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Alex Thomas" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Alex Thomas</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/theChaiChaiTalk/">The Chai Chai Talk</a><a class="page-link" href="/about/">About</a><a class="page-link" href="/Resume/">Resume</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Twitter Search Engine</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-09-04T00:00:00-07:00" itemprop="datePublished">Sep 4, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h3 id="full-stack-web-application">Full-Stack Web Application</h3>

<p>A search engine for crawled tweet data. With a Lucene Index, this search engine has the ability to search millions of tweets and return the most recent and relevant results based on a user query.</p>

<h5 id="project-pipeline-back-end--spring-front-end--react-twitter-dev-api-twitter-4j">Project Pipeline: Back End – Spring, Front End – React, Twitter Dev API, Twitter 4j</h5>

<p><img src="http://localhost:4000/assets/Files/TwitterSearch/front_end_search.png" /></p>

<h2 id="crawl-and-indexing">Crawl and Indexing</h2>

<h3 id="crawl">Crawl</h3>

<p>To crawl twitter, a connection to the Twitter API using a Twitter 4j object and developer keys was made, opening up a stream of tweets. For the tweets, there are two explicit parameters:</p>
<ul>
  <li>Tweets tagged with “English” language</li>
  <li>GPS bounding box for the United States of America</li>
</ul>

<p>Example crawled tweets are located <a href="https://github.com/athom031/TwitterCrawlAndSearch/tree/master/crawl_index/data-sample">here</a>.</p>

<p>Initially, crawled data also included:</p>
<ul>
  <li>Datetime</li>
  <li>Geolocation (Latitude, Longitude)</li>
  <li>User</li>
</ul>

<p>But embedding tweets in front-end application only needed the unique Tweet ID.&lt;/br&gt;
Text and timestamp is kept as parameters for the actual search feature.</p>

<h3 id="indexing">Indexing</h3>

<p>The index structure generated uses the Lucene library object IndexWriter. The index is built by loading all of the .JSON objects in the .JSON line formatted files into memory which are then parsed to create documents for the lucene index.</p>

<p>When a .JSON object (a Tweet) is parsed, the text of the Tweet is stored as a TextField in the index’s document. This is the baseline used when searching the index later. The ID is not used in the tweet itself but is primarily used when representing the tweet on the front end. The timestamp of the Tweet is stored twice: once as a NumericDocValuesField (used for search score boosting) and once as a LongPoint (for drill down serach functionality).</p>

<h2 id="web-application">Web Application</h2>

<h3 id="back-end">Back End</h3>

<p>The LuceneBuilder Class was manipulated to fit the contraints of the Spring framework to create a working backend for search queries. But the default Spring framework proved erraneous due to the front end and back end being on local host in development. This meant that cross origin request errors were not linking the front end and backend properly. Therefore a more specialized <a href="https://spring.io/guides/gs/rest-service-cors/">framework</a> was used.</p>

<p><img src="http://localhost:4000/assets/Files/TwitterSearch/back_end.png" /></p>

<h3 id="front-end">Front End</h3>

<p>The react twitter embed <a href="https://www.npmjs.com/package/react-twitter-embed">component</a> made displaying the relevant tweets quite easy. The only difficulty was that the entire project, initially, was collecting different tweet data. So the Twitter Crawl and Index had to be changed accordingly.</p>

<p>The website changes based on the current state of the App class (depending on whether or not a user has entered a query). Once the query is submitted, it calls the front end to get the ID’s of the 10 most relevant tweets, and uses the embed component to display the tweets in a familiar way.</p>

<p><img src="http://localhost:4000/assets/Files/TwitterSearch/front_end_result.png" /></p>

<h3 id="github-repo">Github Repo</h3>

<p><a href="https://github.com/athom031/TwitterCrawlAndSearch">Check It Out!</a></p>
<h5 id="setup-instructions-included">Setup Instructions Included</h5>

  </div><a class="u-url" href="/2020/09/04/Twitter-Search-Engine.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Alex Thomas</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Alex Thomas</li><li><a class="u-email" href="mailto:alexjosthomas@gmail.com">alexjosthomas@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/athom031"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">athom031</span></a></li><li><a href="https://www.linkedin.com/in/alexjosthomas"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">alexjosthomas</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>A University of California, Riverside Honors Graduate with a B.S. in Computer Science (June 2020).
A team player with a passion for learning and developing new software. 
Let&#39;s get some work done.
</p>
      </div>
    </div>

  </div>

</footer>
<style>
    .videoWrapper {
        position: relative;
        padding-bottom: 56.333%;
        height: 0;
        background: black;
    }
    .videoWrapper iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: 0;
    }    
    </style>
    
    <script>
    function get_youtube_id(url) {
        var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
        return (url.match(p)) ? RegExp.$1 : false;
    }
    function vimeo_embed(url,el) {
        var id = false;
        $.ajax({
          url: 'https://vimeo.com/api/oembed.json?url='+url,
          async: true,
          success: function(response) {
            if(response.video_id) {
              id = response.video_id;
              if(url.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
              if(url.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
              var theInnerHTML = '<div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+id+'/?byline=0&title=0&portrait=0';
              if(autoplay==1) theInnerHTML += '&autoplay=1';
              if(loop==1) theInnerHTML += '&loop=1';
              theInnerHTML += '" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>'; 
              el.innerHTML = theInnerHTML;
            }
          }
        });
    }
    function video_embed() {
        var p = document.getElementsByTagName('p');
        for(var i = 0; i < p.length; i++) {
            //check if this is an external url (that starts with https:// or http://
            if (p[i].innerHTML.indexOf("http://") == 0 ||
                p[i].innerHTML.indexOf("https://") == 0) {
                var youtube_id = get_youtube_id(p[i].innerHTML);
                if(youtube_id) {
                    if(p[i].innerHTML.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                    if(p[i].innerHTML.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                    var theInnerHTML = '<div class="videoWrapper"><iframe width="720" height="420" src="https://www.youtube.com/embed/' + youtube_id + '?rel=0&showinfo=0';
                    if(autoplay==1) theInnerHTML += '&autoplay=1';
                    if(loop==1) theInnerHTML += '&loop=1&playlist='+youtube_id+'&version=3';
                    if(p[i].innerHTML.indexOf('start=') !== -1) theInnerHTML += '&start='+p[i].innerHTML.substring(p[i].innerHTML.indexOf('start=')+6);
                    theInnerHTML += '" frameborder="0" allowfullscreen></iframe></div>';
                    p[i].innerHTML = theInnerHTML;
                }
                if(p[i].innerHTML.indexOf('vimeo.com') !== -1) {
                    //ask vimeo for the id and place the embed
                    vimeo_embed(p[i].innerHTML,p[i]);
                }
            }
        }
    }
    video_embed();
    
    function mp3_embed() {
        var p = document.getElementsByTagName('p');
        for(var i = 0; i < p.length; i++) {
            if(p[i].innerHTML.indexOf('.mp3') !== -1) {
                var str = p[i].innerHTML.split('?');
                if(str.length == 1) str[1] = '';
                var str1 = str[1];
                str1 = str1.replace('&','').replace('&','');
                str1 = str1.replace('autoplay=1','').replace('autoplay=0','');
                str1 = str1.replace('loop=1','').replace('loop=0','');
                str1 = str1.replace('controls=0','').replace('controls=1','');
    
                if (str[0].lastIndexOf('.mp3', str[0].length - 4) === str[0].length - 4 && str1.length == 0) {
                    if(str[1].indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                    if(str[1].indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                    if(str[1].indexOf('controls=0') !== -1) var controls=0; else var controls=1;
                    var newInnerHTML = '<audio';
                    if(autoplay==1) newInnerHTML += ' autoplay';
                    if(loop==1) newInnerHTML += ' loop';
                    if(controls==1) newInnerHTML += ' controls';
                    newInnerHTML += '><source src="'+str[0]+'" type="audio/mpeg">Your browser does not support the audio element.</audio>';
                    p[i].innerHTML = newInnerHTML;
                }
            }
        }
    }
    mp3_embed();
    </script>
  </body>

</html>
